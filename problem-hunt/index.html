<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Problem Hunt - Find Validated Problems to Build</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --background: #ffffff;
            --background-elevated: #f8fafc;
            --foreground: #0f172a;
            --card: #ffffff;
            --card-foreground: #0f172a;
            --popover: #ffffff;
            --popover-foreground: #0f172a;
            --primary: #0f172a;
            --primary-foreground: #ffffff;
            --secondary: #f1f5f9;
            --secondary-foreground: #0f172a;
            --muted: #e2e8f0;
            --muted-foreground: #64748b;
            --accent: #e2e8f0;
            --accent-foreground: #0f172a;
            --destructive: #ef4444;
            --destructive-foreground: #ffffff;
            --border: rgba(15, 23, 42, 0.1);
            --input: #f1f5f9;
            --ring: rgba(34, 211, 238, 0.35);
            --radius: 0.875rem;
            --brand-from: #22d3ee;
            --brand-to: #2563eb;
            --brand-accent: #38bdf8;
            --surface-strong: rgba(15, 23, 42, 0.9);
            --surface: rgba(15, 23, 42, 0.75);
            --surface-soft: rgba(15, 23, 42, 0.6);
            --surface-border: rgba(148, 163, 184, 0.2);
            --surface-border-strong: rgba(148, 163, 184, 0.35);
            --text-muted: #94a3b8;
            --text-subtle: #cbd5e1;
            --success: #34d399;
            --warning: #fbbf24;
        }

        .dark {
            --background: #0a0a0f;
            --background-elevated: #111827;
            --foreground: #e5e7eb;
            --card: #0f172a;
            --card-foreground: #e5e7eb;
            --popover: #0f172a;
            --popover-foreground: #e5e7eb;
            --primary: #e2e8f0;
            --primary-foreground: #0a0a0f;
            --secondary: #111827;
            --secondary-foreground: #e2e8f0;
            --muted: #111827;
            --muted-foreground: #94a3b8;
            --accent: #1f2937;
            --accent-foreground: #e2e8f0;
            --destructive: #f87171;
            --destructive-foreground: #0a0a0f;
            --border: rgba(148, 163, 184, 0.2);
            --input: rgba(15, 23, 42, 0.6);
            --ring: rgba(34, 211, 238, 0.35);
        }

        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            background: var(--background);
            color: var(--foreground);
            line-height: 1.6;
        }

        /* Landing Page */
        .landing {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            background: radial-gradient(1200px 600px at 50% 0%, color-mix(in srgb, var(--brand-from) 20%, transparent), transparent 60%),
                        linear-gradient(135deg, var(--background) 0%, var(--background-elevated) 100%);
            position: relative;
            overflow: hidden;
        }

        .landing::before {
            content: '';
            position: absolute;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.06) 1px, transparent 1px);
            background-size: 50px 50px;
            animation: float 20s linear infinite;
        }

        @keyframes float {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
        }

        .hero {
            max-width: 900px;
            text-align: center;
            position: relative;
            z-index: 1;
        }

        .hero h1 {
            font-size: clamp(3rem, 8vw, 5rem);
            font-weight: 700;
            color: var(--foreground);
            margin-bottom: 1rem;
            text-shadow: 0 8px 30px rgba(0,0,0,0.45);
        }

        .tagline {
            font-size: clamp(1.2rem, 3vw, 1.8rem);
            color: var(--text-subtle);
            margin-bottom: 1rem;
            font-style: italic;
        }

        .subheadline {
            font-size: clamp(1rem, 2.5vw, 1.4rem);
            color: var(--text-muted);
            margin-bottom: 3rem;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }

        .cta-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 4rem;
        }

        .btn {
            padding: 1rem 2.5rem;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 14px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
            min-width: 200px;
            min-height: 56px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .icon {
            width: 1rem;
            height: 1rem;
            stroke: currentColor;
            fill: none;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
            flex-shrink: 0;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--brand-from), var(--brand-to));
            color: var(--primary-foreground);
            box-shadow: 0 8px 24px rgba(34, 211, 238, 0.25);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(34, 211, 238, 0.35);
        }

        .btn-secondary {
            background: var(--surface-soft);
            color: var(--text-subtle);
            border: 1px solid var(--surface-border-strong);
            backdrop-filter: blur(8px);
        }

        .btn-secondary:hover {
            background: rgba(148, 163, 184, 0.15);
            transform: translateY(-2px);
        }

        .value-props {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
            max-width: 800px;
            margin: 0 auto;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
            max-width: 960px;
            margin: 0 auto;
            align-items: stretch;
        }

        .feature-card {
            position: relative;
            border-radius: 20px;
        }

        .feature-glow {
            position: absolute;
            inset: 0;
            border-radius: 20px;
            background: linear-gradient(135deg, rgba(34, 211, 238, 0.08), rgba(37, 99, 235, 0.08));
            filter: blur(24px);
            transition: filter 0.3s ease;
        }

        .feature-glow.alt {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.08), rgba(99, 102, 241, 0.08));
        }

        .feature-card:hover .feature-glow {
            filter: blur(34px);
        }

        .feature-surface {
            position: relative;
            background: rgba(15, 23, 42, 0.5);
            border: 1px solid rgba(148, 163, 184, 0.2);
            border-radius: 20px;
            padding: 2rem;
            backdrop-filter: blur(10px);
            transition: border-color 0.3s ease;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .feature-card:hover .feature-surface {
            border-color: rgba(34, 211, 238, 0.35);
        }

        .feature-card.alt:hover .feature-surface {
            border-color: rgba(59, 130, 246, 0.35);
        }

        .feature-icon {
            width: 48px;
            height: 48px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, rgba(34, 211, 238, 0.45), rgba(37, 99, 235, 0.45));
            box-shadow: 0 0 18px rgba(34, 211, 238, 0.35);
        }

        .feature-card.alt .feature-icon {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.45), rgba(99, 102, 241, 0.45));
            box-shadow: 0 0 18px rgba(99, 102, 241, 0.35);
        }

        .feature-icon svg {
            width: 24px;
            height: 24px;
            color: #7dd3fc;
            filter: drop-shadow(0 0 6px rgba(34, 211, 238, 0.8));
        }

        .feature-card.alt .feature-icon svg {
            color: #93c5fd;
            filter: drop-shadow(0 0 6px rgba(99, 102, 241, 0.8));
        }

        .feature-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #f8fafc;
            margin-bottom: 0.75rem;
        }

        .feature-text {
            color: #94a3b8;
            margin-bottom: 1rem;
        }

        .feature-list {
            list-style: none;
            display: grid;
            gap: 0.5rem;
            font-size: 0.95rem;
            color: #94a3b8;
            margin-top: auto;
        }

        .feature-list li {
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
        }

        .feature-arrow {
            color: #22d3ee;
            margin-top: 2px;
            font-weight: 700;
        }

        .feature-card.alt .feature-arrow {
            color: #60a5fa;
        }

        .value-prop {
            background: var(--surface-soft);
            backdrop-filter: blur(14px);
            padding: 2rem;
            border-radius: 16px;
            border: 1px solid var(--surface-border);
            box-shadow: inset 0 1px 0 rgba(255,255,255,0.04);
        }

        .value-prop h3 {
            color: var(--foreground);
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
        }

        .value-prop p {
            color: var(--text-subtle);
            font-size: 1rem;
        }

        /* App Interface */
        .app {
            display: none;
            min-height: 100vh;
        }

        .app.active {
            display: block;
        }

        .app-header {
            background: var(--surface-strong);
            padding: 1rem 2rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.4);
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid var(--surface-border);
            backdrop-filter: blur(10px);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--brand-accent);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .logo .icon {
            width: 1.25rem;
            height: 1.25rem;
        }

        .search-bar {
            flex: 1;
            max-width: 500px;
            min-width: 200px;
        }

        .auth-buttons {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .auth-buttons span {
            color: var(--text-subtle);
            font-weight: 500;
        }

        .search-bar input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid var(--surface-border-strong);
            border-radius: 10px;
            font-size: 1rem;
            font-family: inherit;
            background: var(--input);
            color: var(--foreground);
        }

        .search-bar input:focus {
            outline: none;
            border-color: var(--brand-from);
            box-shadow: 0 0 0 3px var(--ring);
        }

        .app-container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 250px 1fr 300px;
            gap: 2rem;
            padding: 2rem;
        }

        /* Sidebar */
        .sidebar {
            background: var(--surface);
            padding: 1.5rem;
            border-radius: 12px;
            height: fit-content;
            position: sticky;
            top: 100px;
            border: 1px solid var(--surface-border);
            box-shadow: 0 10px 30px rgba(0,0,0,0.35);
        }

        .sidebar h3 {
            font-size: 1.1rem;
            margin-bottom: 1rem;
            color: var(--foreground);
        }

        .filter-group {
            margin-bottom: 1.5rem;
        }

        .filter-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text-subtle);
            font-size: 0.9rem;
        }

        .filter-group select {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid var(--surface-border-strong);
            border-radius: 8px;
            font-family: inherit;
            font-size: 0.9rem;
            background: var(--input);
            color: var(--foreground);
        }

        /* Main Feed */
        .main-feed {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .feed-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .feed-header h2 {
            font-size: 1.8rem;
            color: var(--foreground);
        }

        .sort-dropdown select {
            padding: 0.75rem 1rem;
            border: 1px solid var(--surface-border-strong);
            border-radius: 10px;
            font-family: inherit;
            font-size: 0.95rem;
            cursor: pointer;
            background: var(--input);
            color: var(--foreground);
        }

        /* Problem Cards */
        .problem-card {
            background: var(--surface);
            padding: 1.5rem;
            border-radius: 14px;
            box-shadow: 0 12px 40px rgba(0,0,0,0.35);
            transition: all 0.3s ease;
            border: 1px solid var(--surface-border);
        }

        .problem-card:hover {
            box-shadow: 0 18px 60px rgba(0,0,0,0.45);
            transform: translateY(-2px);
            border-color: rgba(34, 211, 238, 0.35);
        }

        .card-header {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .upvote-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.25rem;
            padding: 0.5rem;
            background: var(--surface-soft);
            border: 1px solid var(--surface-border-strong);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            min-width: 60px;
        }

        .upvote-btn:hover {
            background: rgba(148,163,184,0.15);
        }

        .upvote-btn.upvoted {
            background: rgba(16,185,129,0.15);
            border-color: rgba(16,185,129,0.7);
        }

        .upvote-icon {
            font-size: 1.2rem;
            color: #22d3ee;
            text-shadow: 0 0 8px rgba(34, 211, 238, 0.6);
        }

        .upvote-count {
            font-weight: 600;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            color: var(--foreground);
        }

        .card-content {
            flex: 1;
        }

        .problem-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--foreground);
            margin-bottom: 0.5rem;
            line-height: 1.3;
        }

        .problem-description {
            color: var(--text-muted);
            margin-bottom: 1rem;
            line-height: 1.5;
        }

        .card-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            align-items: center;
            margin-bottom: 1rem;
        }

        .category-tag {
            background: rgba(34, 211, 238, 0.15);
            color: var(--brand-accent);
            padding: 0.25rem 0.75rem;
            border-radius: 6px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .budget {
            font-weight: 700;
            color: var(--success);
            font-size: 1.1rem;
            font-family: 'Courier New', monospace;
        }

        .stat {
            color: var(--text-muted);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 1rem;
            border-top: 1px solid var(--surface-border);
        }

        .author {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--brand-from) 0%, var(--brand-to) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-foreground);
            font-weight: 600;
            font-size: 0.8rem;
        }

        .submit-proposal {
            background: linear-gradient(135deg, var(--brand-from), var(--brand-to));
            color: var(--primary-foreground);
            padding: 0.5rem 1.5rem;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            font-family: inherit;
            transition: all 0.2s ease;
            min-height: 44px;
        }

        .submit-proposal:hover {
            transform: translateY(-1px);
            box-shadow: 0 8px 20px rgba(124,58,237,0.35);
        }

        .proposal-badge {
            background: rgba(251, 191, 36, 0.15);
            color: var(--warning);
            padding: 0.25rem 0.75rem;
            border-radius: 6px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .proposals-section {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(148,163,184,0.2);
        }

        .proposal-card {
            background: var(--surface-soft);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 0.75rem;
            border: 1px solid var(--surface-border);
        }

        .proposal-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 0.5rem;
        }

        .tip-btn {
            background: rgba(16,185,129,0.2);
            color: #34D399;
            border: none;
            padding: 0.25rem 0.75rem;
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: background 0.3s ease;
            border: 1px solid rgba(16,185,129,0.4);
        }

        .tip-btn:hover {
            background: rgba(16,185,129,0.3);
        }

        .proposal-title {
            font-weight: 600;
            color: var(--foreground);
            font-size: 1rem;
        }

        .proposal-description {
            color: var(--text-muted);
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .proposal-meta {
            display: flex;
            gap: 1rem;
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .proposal-link {
            color: var(--brand-accent);
            text-decoration: none;
        }

        .proposal-link:hover {
            text-decoration: underline;
        }

        .view-proposals-btn {
            background: transparent;
            color: var(--brand-accent);
            border: 1px solid rgba(56, 189, 248, 0.6);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .view-proposals-btn:hover {
            background: rgba(56, 189, 248, 0.1);
        }

        .empty-proposals {
            text-align: center;
            color: var(--text-muted);
            padding: 2rem;
            font-style: italic;
        }

        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--text-muted);
        }

        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--foreground);
        }

        .empty-state p {
            margin-bottom: 2rem;
        }

        /* Right Sidebar */
        .right-sidebar {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .widget {
            background: var(--surface);
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 12px 40px rgba(0,0,0,0.35);
            border: 1px solid var(--surface-border);
        }

        .widget h3 {
            font-size: 1.1rem;
            margin-bottom: 1rem;
            color: var(--foreground);
        }

        /* FAB */
        .fab {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: linear-gradient(135deg, var(--brand-from), var(--brand-to));
            color: var(--primary-foreground);
            width: 64px;
            height: 64px;
            border-radius: 50%;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            box-shadow: 0 8px 24px rgba(124,58,237,0.45);
            transition: all 0.3s ease;
            z-index: 90;
        }

        .fab:hover {
            transform: scale(1.06);
            box-shadow: 0 12px 30px rgba(124,58,237,0.55);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(2,6,23,0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--surface-strong);
            padding: 2rem;
            border-radius: 16px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid var(--surface-border);
            box-shadow: 0 24px 60px rgba(0,0,0,0.45);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-header h2 {
            font-size: 1.8rem;
            color: var(--foreground);
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            color: var(--text-muted);
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-subtle);
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--surface-border-strong);
            border-radius: 10px;
            font-family: inherit;
            font-size: 1rem;
            background: var(--input);
            color: var(--foreground);
        }

        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--brand-from);
            box-shadow: 0 0 0 3px var(--ring);
        }

        .submit-btn {
            width: 100%;
            background: linear-gradient(135deg, var(--brand-from), var(--brand-to));
            color: var(--primary-foreground);
            padding: 1rem;
            border-radius: 10px;
            border: none;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            font-family: inherit;
            transition: all 0.2s ease;
            box-shadow: 0 10px 24px rgba(124,58,237,0.35);
        }

        .submit-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 14px 32px rgba(34, 211, 238, 0.35);
        }

        /* Mobile Menu */
        .mobile-menu-btn {
            display: none;
            background: var(--surface-soft);
            color: var(--text-subtle);
            border: 1px solid var(--surface-border-strong);
            padding: 0.5rem 1rem;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            min-height: 44px;
            min-width: 44px;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .app-container {
                grid-template-columns: 1fr 300px;
            }

            .sidebar {
                display: none;
            }

            .sidebar.mobile-active {
                display: block;
                position: fixed;
                top: 0;
                left: 0;
                width: 280px;
                height: 100vh;
                z-index: 200;
                overflow-y: auto;
                box-shadow: 2px 0 20px rgba(0,0,0,0.5);
            }

            .mobile-menu-btn {
                display: block;
            }
        }

        @media (max-width: 768px) {
            .app-container {
                grid-template-columns: 1fr;
                padding: 1rem;
                gap: 1rem;
            }

            .right-sidebar {
                display: none;
            }

            .header-content {
                padding: 0;
            }

            .search-bar {
                order: 3;
                width: 100%;
                max-width: 100%;
            }

            .app-header {
                padding: 1rem;
            }

            .fab {
                bottom: 1rem;
                right: 1rem;
                width: 56px;
                height: 56px;
                font-size: 1.5rem;
            }

            .card-header {
                flex-direction: column;
            }

            .upvote-btn {
                align-self: flex-start;
            }
        }
    </style>
</head>
<body class="dark">
    <!-- Landing Page -->
    <div class="landing" id="landing">
        <div class="hero">
            <h1>Problem Hunt</h1>
            <p class="tagline">Houston, we have a problem.</p>
            <p class="subheadline">The marketplace where people post problems they'd pay to solve - and builders compete to solve them.</p>
            
            <div class="cta-buttons">
                <button class="btn btn-primary" onclick="showApp()">
                    <svg class="icon" viewBox="0 0 24 24" aria-hidden="true" style="width: 20px; height: 20px; margin-right: 0.25rem;">
                        <path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z" />
                        <path d="m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z" />
                        <path d="M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0" />
                        <path d="M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5" />
                    </svg>
                    Browse Problems
                </button>
                <button class="btn btn-secondary" onclick="showApp(); showModal()">
                    <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                        <path d="M12 5v14" />
                        <path d="M5 12h14" />
                    </svg>
                    Post a Problem
                </button>
            </div>

            <div class="feature-grid">
                <div class="feature-card" onclick="showApp()" style="cursor: pointer;">
                    <div class="feature-glow"></div>
                    <div class="feature-surface">
                        <div class="feature-icon">
                            <svg viewBox="0 0 24 24" aria-hidden="true">
                                <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2" />
                            </svg>
                        </div>
                        <h3 class="feature-title">For people with problems</h3>
                        <p class="feature-text">Signal demand. Get solutions built.</p>
                        <ul class="feature-list">
                            <li><span class="feature-arrow">→</span><span>Post your problem with bounty details</span></li>
                            <li><span class="feature-arrow">→</span><span>Track builder progress in real-time</span></li>
                            <li><span class="feature-arrow">→</span><span>Only pay when satisfied with solution</span></li>
                        </ul>
                    </div>
                </div>
                <div class="feature-card alt" onclick="showAuthModal('signup')" style="cursor: pointer;">
                    <div class="feature-glow alt"></div>
                    <div class="feature-surface">
                        <div class="feature-icon">
                            <svg viewBox="0 0 24 24" aria-hidden="true">
                                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18" />
                                <polyline points="17 6 23 6 23 12" />
                            </svg>
                        </div>
                        <h3 class="feature-title">For builders</h3>
                        <p class="feature-text">Find validated problems. Build what people actually want.</p>
                        <ul class="feature-list">
                            <li><span class="feature-arrow">→</span><span>Browse problems with real market demand</span></li>
                            <li><span class="feature-arrow">→</span><span>Post progress updates to get tipped</span></li>
                            <li><span class="feature-arrow">→</span><span>Earn bounties for successful solutions</span></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- App Interface -->
    <div class="app" id="app">
        <header class="app-header">
            <div class="header-content">
                <a class="logo" onclick="showLanding()">
                    <div style="width: 32px; height: 32px; background: linear-gradient(135deg, var(--brand-from), var(--brand-to)); border-radius: 10px; display: flex; align-items: center; justify-content: center;">
                        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true" style="width: 20px; height: 20px; color: white;">
                            <polyline points="16 18 22 12 16 6" />
                            <polyline points="8 6 2 12 8 18" />
                        </svg>
                    </div>
                    <span style="font-size: 1.25rem; font-weight: 700; background: linear-gradient(90deg, var(--brand-from), var(--brand-to)); -webkit-background-clip: text; background-clip: text; color: transparent;">problemhunt.cc</span>
                </a>
                <button class="mobile-menu-btn" onclick="toggleMobileMenu()">☰ Filters</button>
                <div class="search-bar">
                    <input type="text" placeholder="Search problems..." id="searchInput" onkeyup="filterProblems()">
                </div>
                <div id="authButtons" class="auth-buttons">
                    <button class="btn btn-secondary" onclick="showAuthModal('signin')">
                        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                            <path d="M15 3h4a2 2 0 0 1 2 2v4" />
                            <path d="M10 14l4-4-4-4" />
                            <path d="M14 10H3" />
                            <path d="M15 21h4a2 2 0 0 0 2-2v-4" />
                        </svg>
                        Sign In
                    </button>
                    <button class="btn btn-primary" onclick="showAuthModal('signup')">
                        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" />
                            <circle cx="9" cy="7" r="4" />
                            <path d="M19 8v6" />
                            <path d="M22 11h-6" />
                        </svg>
                        Sign Up
                    </button>
                </div>
            </div>
        </header>

        <div class="app-container">
            <!-- Left Sidebar -->
            <aside class="sidebar" id="sidebar">
                <h3>
                    <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                        <path d="M3 6h18" />
                        <path d="M7 12h10" />
                        <path d="M10 18h4" />
                    </svg>
                    Filters
                </h3>
                
                <div class="filter-group">
                    <label>Category</label>
                    <select id="categoryFilter" onchange="filterProblems()">
                        <option value="all">All Categories</option>
                        <option value="Productivity">Productivity</option>
                        <option value="Social">Social</option>
                        <option value="Finance">Finance</option>
                        <option value="Health">Health</option>
                        <option value="Developer Tools">Developer Tools</option>
                        <option value="Entertainment">Entertainment</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label>Budget Range</label>
                    <select id="budgetFilter" onchange="filterProblems()">
                        <option value="all">All Budgets</option>
                        <option value="0-10">$0 - $10</option>
                        <option value="10-25">$10 - $25</option>
                        <option value="25-50">$25 - $50</option>
                        <option value="50+">$50+</option>
                    </select>
                </div>
            </aside>

            <!-- Main Feed -->
            <main class="main-feed">
                <div class="feed-header">
                    <h2>All Problems</h2>
                    <div class="sort-dropdown">
                        <select id="sortSelect" onchange="sortProblems()">
                            <option value="upvotes">Most Upvotes</option>
                            <option value="newest">Newest</option>
                            <option value="budget">Highest Budget</option>
                        </select>
                    </div>
                </div>

                <div id="problemFeed"></div>
            </main>

            <!-- Right Sidebar -->
            <aside class="right-sidebar">
                <div class="widget">
                    <h3>
                        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                            <path d="M5 15l-2 6 6-2" />
                            <path d="M14 3c4.4 0 7 2.6 7 7l-7 7-6-1-1-6 7-7z" />
                            <path d="M9 14l5-5" />
                        </svg>
                        Getting Started
                    </h3>
                    <p style="color: #6B7280; margin-bottom: 1rem;">Welcome to Problem Hunt! Here's how it works:</p>
                    <ol style="color: #6B7280; padding-left: 1.25rem;">
                        <li style="margin-bottom: 0.5rem;">Browse problems people want solved</li>
                        <li style="margin-bottom: 0.5rem;">Submit proposals for problems you can solve</li>
                        <li style="margin-bottom: 0.5rem;">Get direct access to paying customers</li>
                    </ol>
                </div>

                <div class="widget">
                    <h3>
                        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                            <path d="M12 3a6 6 0 0 0-3 11.2V17a3 3 0 0 0 6 0v-2.8A6 6 0 0 0 12 3z" />
                            <path d="M9 21h6" />
                        </svg>
                        Post Your Problem
                    </h3>
                    <p style="color: #6B7280; margin-bottom: 1rem;">Have a problem that needs solving? Post it and see if builders want to help!</p>
                    <button class="btn btn-primary" style="width: 100%; min-width: auto;" onclick="showModal()">
                        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                            <path d="M12 5v14" />
                            <path d="M5 12h14" />
                        </svg>
                        Post Problem
                    </button>
                </div>
            </aside>
        </div>

        <button class="fab" onclick="showModal()">+</button>
    </div>

    <!-- Problem Modal -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Post a Problem</h2>
                <button class="close-modal" onclick="closeModal()">×</button>
            </div>
            
            <form id="problemForm">
                <div class="form-group">
                    <label>Problem Title</label>
                    <input type="text" id="problemTitle" placeholder="What problem do you need solved?" required>
                </div>

                <div class="form-group">
                    <label>Description</label>
                    <textarea id="problemDescription" placeholder="Describe your problem in detail..." required></textarea>
                </div>

                <div class="form-group">
                    <label>Category</label>
                    <select id="problemCategory" required>
                        <option value="">Select a category</option>
                        <option value="Productivity">Productivity</option>
                        <option value="Social">Social</option>
                        <option value="Finance">Finance</option>
                        <option value="Health">Health</option>
                        <option value="Developer Tools">Developer Tools</option>
                        <option value="Entertainment">Entertainment</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>I'd pay this much</label>
                    <input type="text" id="problemBudget" placeholder="e.g., $20/month or $5/use" required>
                </div>

                <div class="form-group">
                    <label>Your Name (optional)</label>
                    <input type="text" id="problemAuthor" placeholder="Your name">
                </div>

                <button type="submit" class="submit-btn">Submit Problem</button>
            </form>
        </div>
    </div>

    <!-- Proposal Modal -->
    <div class="modal" id="proposalModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Submit Proposal</h2>
                <button class="close-modal" onclick="closeProposalModal()">×</button>
            </div>
            
            <div style="background: #F3F4F6; padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem;">
                <strong>Problem:</strong>
                <p id="proposalProblemTitle" style="margin-top: 0.5rem; color: #374151;"></p>
            </div>

            <form id="proposalForm">
                <input type="hidden" id="proposalProblemId">
                
                <div class="form-group">
                    <label>Solution Title</label>
                    <input type="text" id="proposalTitle" placeholder="What's your solution called?" required>
                </div>

                <div class="form-group">
                    <label>How will you solve it?</label>
                    <textarea id="proposalDescription" placeholder="Describe your proposed solution in detail..." required></textarea>
                </div>

                <div class="form-group">
                    <label>Timeline</label>
                    <input type="text" id="proposalTimeline" placeholder="e.g., 2 weeks, 1 month" required>
                </div>

                <div class="form-group">
                    <label>Your Name</label>
                    <input type="text" id="proposalBuilderName" placeholder="Your name or company" required>
                </div>

                <div class="form-group">
                    <label>GitHub URL (optional)</label>
                    <input type="url" id="proposalGithubUrl" placeholder="https://github.com/yourusername">
                </div>

                <div class="form-group">
                    <label>Demo URL (optional)</label>
                    <input type="url" id="proposalDemoUrl" placeholder="https://your-demo.com">
                </div>

                <button type="submit" class="submit-btn">Submit Proposal</button>
            </form>
        </div>
    </div>

    <!-- Auth Modal -->
    <div class="modal" id="authModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="authModalTitle">Sign In</h2>
                <button class="close-modal" onclick="closeAuthModal()">×</button>
            </div>
            
            <div id="authForms">
                <!-- Sign In Form -->
                <form id="signInForm" style="display: block;">
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="signInEmail" placeholder="your@email.com" required>
                    </div>

                    <div class="form-group">
                        <label>Password</label>
                        <input type="password" id="signInPassword" placeholder="Your password" required>
                    </div>

                    <button type="submit" class="submit-btn">Sign In</button>
                    <p style="text-align: center; margin-top: 1rem;">
                        Don't have an account? 
                        <a href="#" onclick="showSignUpForm()">Sign up</a>
                    </p>
                </form>

                <!-- Sign Up Form -->
                <form id="signUpForm" style="display: none;">
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="signUpEmail" placeholder="your@email.com" required>
                    </div>

                    <div class="form-group">
                        <label>Password</label>
                        <input type="password" id="signUpPassword" placeholder="Create a password" required>
                    </div>

                    <div class="form-group">
                        <label>Display Name</label>
                        <input type="text" id="signUpName" placeholder="Your name or username" required>
                    </div>

                    <button type="submit" class="submit-btn">Sign Up</button>
                    <p style="text-align: center; margin-top: 1rem;">
                        Already have an account? 
                        <a href="#" onclick="showSignInForm()">Sign in</a>
                    </p>
                </form>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="lib/config.js"></script>
    <script>
        // API Configuration
        const API_BASE_URL = window.location.hostname === 'localhost' 
            ? '/api'
            : '/api';

        // Supabase Configuration - Loaded from config.js
        // DO NOT hardcode credentials here - use environment variables

        // Current user state
        let currentUser = null;

        // Auth functions
        async function initAuth() {
            const { data: { session } } = await supabase.auth.getSession();
            currentUser = session?.user || null;
            updateAuthUI();
        }

        function updateAuthUI() {
            const authButtons = document.getElementById('authButtons');
            if (currentUser) {
                authButtons.innerHTML = `
                    <span>Welcome, ${currentUser.user_metadata?.name || currentUser.email}!</span>
                    <button class="btn btn-secondary" onclick="signOut()">Sign Out</button>
                `;
            } else {
                authButtons.innerHTML = `
                    <button class="btn btn-secondary" onclick="showAuthModal('signin')">Sign In</button>
                    <button class="btn btn-primary" onclick="showAuthModal('signup')">Sign Up</button>
                `;
            }
        }

        function showAuthModal(type) {
            document.getElementById('authModal').classList.add('active');
            if (type === 'signup') {
                showSignUpForm();
            } else {
                showSignInForm();
            }
        }

        function closeAuthModal() {
            document.getElementById('authModal').classList.remove('active');
            document.getElementById('signInForm').reset();
            document.getElementById('signUpForm').reset();
        }

        function showSignInForm() {
            document.getElementById('signInForm').style.display = 'block';
            document.getElementById('signUpForm').style.display = 'none';
            document.getElementById('authModalTitle').textContent = 'Sign In';
        }

        function showSignUpForm() {
            document.getElementById('signInForm').style.display = 'none';
            document.getElementById('signUpForm').style.display = 'block';
            document.getElementById('authModalTitle').textContent = 'Sign Up';
        }

        async function signOut() {
            await supabase.auth.signOut();
            currentUser = null;
            updateAuthUI();
        }

        // Initial data - just one example
        let problems = [
            {
                id: '1',
                title: 'A browser extension that blocks LinkedIn recruiters unless they mention salary',
                description: 'Tired of "exciting opportunity" messages that waste my time. Only show me messages that include actual compensation information upfront.',
                category: 'Productivity',
                budgetValue: 10,
                upvotes: 127,
                proposals: 3,
                author: 'Anonymous User',
                time: '2 hours ago',
                upvoted: false
            }
        ];

        let allProblems = [...problems];

        // Page navigation
        function showLanding() {
            document.getElementById('landing').style.display = 'flex';
            document.getElementById('app').classList.remove('active');
        }

        function showApp() {
            document.getElementById('landing').style.display = 'none';
            document.getElementById('app').classList.add('active');
            loadProblems();
        }

        function toggleMobileMenu() {
            document.getElementById('sidebar').classList.toggle('mobile-active');
        }

        // Modal functions
        function showModal() {
            document.getElementById('modal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('modal').classList.remove('active');
            document.getElementById('problemForm').reset();
        }

        function showProposalModal(problemId, problemTitle) {
            if (!currentUser) {
                alert('Please sign in to submit a proposal.');
                showAuthModal('signin');
                return;
            }
            document.getElementById('proposalModal').classList.add('active');
            document.getElementById('proposalProblemId').value = problemId;
            document.getElementById('proposalProblemTitle').textContent = problemTitle;
        }

        function closeProposalModal() {
            document.getElementById('proposalModal').classList.remove('active');
            document.getElementById('proposalForm').reset();
        }

        // Load problems from API or use local data
        async function loadProblems() {
            try {
                const response = await fetch(`${API_BASE_URL}/problems`);
                if (response.ok) {
                    const data = await response.json();
                    allProblems = data.problems || data;
                    problems = [...allProblems];
                    renderProblems(problems);
                } else {
                    renderProblems(problems);
                }
            } catch (error) {
                console.log('Using local data');
                renderProblems(problems);
            }
        }

        // Render problems
        function renderProblems(problemsToRender) {
            const feed = document.getElementById('problemFeed');
            
            if (problemsToRender.length === 0) {
                feed.innerHTML = `
                    <div class="empty-state">
                        <h3>No problems found</h3>
                        <p>Be the first to post a problem that needs solving!</p>
                        <button class="btn btn-primary" onclick="showModal()">Post a Problem</button>
                    </div>
                `;
                return;
            }

            feed.innerHTML = problemsToRender.map(p => `
                <div class="problem-card">
                    <div class="card-header">
                        <button class="upvote-btn ${p.upvoted ? 'upvoted' : ''}" onclick="toggleUpvote('${p.id}')">
                            <span class="upvote-icon">▲</span>
                            <span class="upvote-count">${p.upvotes}</span>
                        </button>
                        <div class="card-content">
                            <h3 class="problem-title">${p.title}</h3>
                            <p class="problem-description">${p.description}</p>
                            <div class="card-meta">
                                <span class="category-tag">${p.category}</span>
                                <span class="budget">${p.budget}</span>
                                <span class="stat">${p.proposals} proposal${p.proposals !== 1 ? 's' : ''}</span>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer">
                        <div class="author">
                            <div class="avatar">${p.author.substring(0, 2).toUpperCase()}</div>
                            <span>Posted by ${p.author} • ${p.time}</span>
                        </div>
                        <div style="display: flex; gap: 0.5rem;">
                            ${p.proposals > 0 ? `<button class="view-proposals-btn" onclick="viewProposals('${p.id}')">View ${p.proposals} Proposal${p.proposals > 1 ? 's' : ''}</button>` : ''}
                            <button class="submit-proposal" onclick="showProposalModal('${p.id}', '${p.title.replace(/'/g, "\\'")}')">Submit Proposal</button>
                        </div>
                    </div>
                    <div class="proposals-section" id="proposals-${p.id}" style="display: none;"></div>
                </div>
            `).join('');
        }

        // Toggle upvote
        async function toggleUpvote(problemId) {
            const problem = problems.find(p => p.id === problemId);
            if (!problem) return;

            try {
                if (problem.upvoted) {
                    const response = await fetch(`${API_BASE_URL}/problems/${problemId}/upvote`, {
                        method: 'DELETE'
                    });
                    if (response.ok) {
                        problem.upvoted = false;
                        problem.upvotes -= 1;
                    }
                } else {
                    const response = await fetch(`${API_BASE_URL}/problems/${problemId}/upvote`, {
                        method: 'POST'
                    });
                    if (response.ok) {
                        problem.upvoted = true;
                        problem.upvotes += 1;
                    }
                }
            } catch (error) {
                // Fallback to local state
                problem.upvoted = !problem.upvoted;
                problem.upvotes += problem.upvoted ? 1 : -1;
            }
            
            renderProblems(problems);
        }

        // View proposals
        async function viewProposals(problemId) {
            const proposalsSection = document.getElementById(`proposals-${problemId}`);
            
            if (proposalsSection.style.display === 'block') {
                proposalsSection.style.display = 'none';
                return;
            }

            proposalsSection.innerHTML = '<p style="text-align: center; color: #6B7280;">Loading proposals...</p>';
            proposalsSection.style.display = 'block';

            try {
                const response = await fetch(`${API_BASE_URL}/problems/${problemId}/proposals`);
                const data = await response.json();

                if (data.proposals && data.proposals.length > 0) {
                    proposalsSection.innerHTML = `
                        <h4 style="margin-bottom: 1rem; color: #111827;">💡 Solution Proposals (${data.proposals.length})</h4>
                        ${data.proposals.map(proposal => `
                            <div class="proposal-card">
                                <div class="proposal-header">
                                    <div>
                                        <div class="proposal-title">${proposal.title}</div>
                                        <div class="proposal-meta">
                                            <span>👤 ${proposal.builderName}</span>
                                            <span>⏱️ ${proposal.timeline}</span>
                                            <span class="proposal-badge">${proposal.status}</span>
                                        </div>
                                    </div>
                                    <button class="tip-btn" onclick="tipBuilder('${proposal.id}', '${proposal.builderName}')">💰 Tip</button>
                                </div>
                                <p class="proposal-description">${proposal.description}</p>
                                ${proposal.githubUrl || proposal.demoUrl ? `
                                    <div class="proposal-meta">
                                        ${proposal.githubUrl ? `<a href="${proposal.githubUrl}" target="_blank" class="proposal-link">🔗 GitHub</a>` : ''}
                                        ${proposal.demoUrl ? `<a href="${proposal.demoUrl}" target="_blank" class="proposal-link">🚀 Demo</a>` : ''}
                                    </div>
                                ` : ''}
                            </div>
                        `).join('')}
                    `;
                } else {
                    proposalsSection.innerHTML = '<div class="empty-proposals">No proposals yet. Be the first to submit a solution! 🚀</div>';
                }
            } catch (error) {
                console.error('Error loading proposals:', error);
                proposalsSection.innerHTML = '<div class="empty-proposals">Failed to load proposals. Please try again.</div>';
            }
        }

        // Tip builder
        async function tipBuilder(proposalId, builderName) {
            if (!currentUser) {
                alert('Please sign in to tip builders.');
                showAuthModal('signin');
                return;
            }

            const amount = prompt(`How much would you like to tip ${builderName}? (e.g., 5, 10, 25)`);
            if (!amount || isNaN(amount) || amount <= 0) {
                return;
            }

            try {
                const response = await fetch(`${API_BASE_URL}/proposals/${proposalId}/tip`, {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${(await supabase.auth.getSession()).data.session?.access_token}`
                    },
                    body: JSON.stringify({ amount: parseFloat(amount) })
                });

                if (response.ok) {
                    alert(`Thank you for tipping ${builderName} $${amount}!`);
                } else {
                    throw new Error('Failed to process tip');
                }
            } catch (error) {
                console.error('Error tipping builder:', error);
                alert('Failed to process tip. Please try again.');
            }
        }

        // Filter and sort
        function filterProblems() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const category = document.getElementById('categoryFilter').value;
            const budgetRange = document.getElementById('budgetFilter').value;

            problems = allProblems.filter(p => {
                const matchesSearch = p.title.toLowerCase().includes(searchTerm) || 
                                     p.description.toLowerCase().includes(searchTerm);
                const matchesCategory = category === 'all' || p.category === category;
                
                let matchesBudget = true;
                if (budgetRange !== 'all') {
                    const [min, max] = budgetRange.split('-');
                    if (max === undefined) {
                        matchesBudget = p.budgetValue >= parseInt(min);
                    } else {
                        matchesBudget = p.budgetValue >= parseInt(min) && p.budgetValue <= parseInt(max);
                    }
                }

                return matchesSearch && matchesCategory && matchesBudget;
            });

            sortProblems();
        }

        function sortProblems() {
            const sortBy = document.getElementById('sortSelect').value;
            
            if (sortBy === 'upvotes') {
                problems.sort((a, b) => b.upvotes - a.upvotes);
            } else if (sortBy === 'newest') {
                problems.sort((a, b) => {
                    const timeA = parseTimeAgo(a.time);
                    const timeB = parseTimeAgo(b.time);
                    return timeA - timeB;
                });
            } else if (sortBy === 'budget') {
                problems.sort((a, b) => b.budgetValue - a.budgetValue);
            }

            renderProblems(problems);
        }

        function parseTimeAgo(timeStr) {
            const match = timeStr.match(/(\d+)\s+(minute|hour|day|week)/);
            if (!match) return 0;
            const value = parseInt(match[1]);
            const unit = match[2];
            const multipliers = { minute: 1, hour: 60, day: 1440, week: 10080 };
            return value * (multipliers[unit] || 0);
        }

        // Form submissions
        document.getElementById('problemForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const newProblem = {
                title: document.getElementById('problemTitle').value,
                description: document.getElementById('problemDescription').value,
                category: document.getElementById('problemCategory').value,
                budget: document.getElementById('problemBudget').value,
                author: currentUser?.user_metadata?.name || currentUser?.email || document.getElementById('problemAuthor').value || 'Anonymous User',
                userId: currentUser?.id
            };

            try {
                const headers = { 'Content-Type': 'application/json' };
                
                // Only add authorization header if user is signed in
                if (currentUser) {
                    headers['Authorization'] = `Bearer ${(await supabase.auth.getSession()).data.session?.access_token}`;
                }

                const response = await fetch(`${API_BASE_URL}/problems`, {
                    method: 'POST',
                    headers: headers,
                    body: JSON.stringify(newProblem)
                });

                if (response.ok) {
                    const created = await response.json();
                    allProblems.unshift(created);
                    problems = [...allProblems];
                    renderProblems(problems);
                    closeModal();
                    alert('🎉 Problem posted successfully!');
                } else {
                    throw new Error('Failed to create problem');
                }
            } catch (error) {
                // Fallback to local
                const localProblem = {
                    id: String(Date.now()),
                    ...newProblem,
                    budgetValue: parseInt(newProblem.budget.match(/\d+/)?.[0] || '0'),
                    upvotes: 0,
                    proposals: 0,
                    time: 'just now',
                    upvoted: false
                };
                allProblems.unshift(localProblem);
                problems = [...allProblems];
                renderProblems(problems);
                closeModal();
                alert('🎉 Problem posted successfully!');
            }
        });

        document.getElementById('proposalForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            if (!currentUser) {
                alert('Please sign in to submit a proposal.');
                showAuthModal('signin');
                return;
            }

            const problemId = document.getElementById('proposalProblemId').value;
            
            const proposalData = {
                title: document.getElementById('proposalTitle').value,
                description: document.getElementById('proposalDescription').value,
                timeline: document.getElementById('proposalTimeline').value,
                builderName: document.getElementById('proposalBuilderName').value,
                githubUrl: document.getElementById('proposalGithubUrl').value || null,
                demoUrl: document.getElementById('proposalDemoUrl').value || null,
                userId: currentUser.id
            };

            try {
                const response = await fetch(`${API_BASE_URL}/problems/${problemId}/proposals`, {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${(await supabase.auth.getSession()).data.session?.access_token}`
                    },
                    body: JSON.stringify(proposalData)
                });

                if (response.ok) {
                    const problem = problems.find(p => p.id === problemId);
                    if (problem) {
                        problem.proposals += 1;
                        renderProblems(problems);
                    }
                    
                    closeProposalModal();
                    alert('🎉 Proposal submitted successfully! The problem owner will be notified.');
                } else {
                    throw new Error('Failed to submit proposal');
                }
            } catch (error) {
                console.error('Error submitting proposal:', error);
                alert('Failed to submit proposal. Please try again.');
            }
        });

        // Auth form submissions
        document.getElementById('signInForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const email = document.getElementById('signInEmail').value;
            const password = document.getElementById('signInPassword').value;

            try {
                const { data, error } = await supabase.auth.signInWithPassword({
                    email,
                    password
                });

                if (error) throw error;

                currentUser = data.user;
                updateAuthUI();
                closeAuthModal();
                alert('Welcome back!');
            } catch (error) {
                alert('Sign in failed: ' + error.message);
            }
        });

        document.getElementById('signUpForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const email = document.getElementById('signUpEmail').value;
            const password = document.getElementById('signUpPassword').value;
            const name = document.getElementById('signUpName').value;

            try {
                const { data, error } = await supabase.auth.signUp({
                    email,
                    password,
                    options: {
                        data: {
                            name: name
                        }
                    }
                });

                if (error) throw error;

                alert('Check your email for confirmation!');
                closeAuthModal();
            } catch (error) {
                alert('Sign up failed: ' + error.message);
            }
        });

        // Initialize on page load
        initAuth();
        renderProblems(problems);
    </script>
</body>
</html>